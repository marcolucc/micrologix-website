function redirect(URL) {parent.frames.home.location.href=URL;}
function parseQuery(){ var querystr, queryindex; querystr=""+parent.parent.document.location.href; if((queryindex=querystr.indexOf('?'))!= -1){ querystr=querystr.substring(queryindex + 1); if((queryindex=querystr.indexOf('redirect='))!= -1){ querystr=querystr.substring(queryindex + 9); if(querystr!=this.location.pathname){redirect(querystr);}} else alert("Invalid Query String");}}
function frame_check(){ if(top==self){ var newUrl = "./index.htm?redirect=" + document.location.pathname; var replaceOK = true; if(navigator.appName.indexOf("Microsoft")>-1){if(parseInt(navigator.appVersion)<4){replaceOK=false;}} if(replaceOK){location.replace(newUrl);}else{document.location.href=newUrl;}} if(self){if(self.name=="home"){top.frames.home.focus();}}}